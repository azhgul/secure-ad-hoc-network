root@batman4:~/secure-ad-hoc-network# batmand --role sp -d 4 wlan0
Secure Ad Hoc Network extension enabled
Interface activated: wlan0
Using interface wlan0 with address 10.0.0.4 and broadcast address 10.0.0.255
B.A.T.M.A.N. 0.3.2 (compatibility version 5)
debug level: 4
Attempting to seed the PRNG...
Successfully seeded the PRNG with 1024 bytes from /dev/urandom.
[         0] schedule_own_packet(): wlan0 
[         0]  
Generated Master Key: 54:83:FC:60:30:E7:D3:87:47:E5:E1:79:64:D9:35:EE
..............................++++++
.........++++++

Added new node to AL:
ID           : 1034
IP ADDRESS   : 10.0.0.4
ROLE         : Authenticated Node
Subject Name : SP_1132445131
Public Key   :
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCuGcve0ZI4NCsJfOf8bR5CAJWT
hlVtWU/6lvewmE3XjRPe19hQ5gI+XpsLJWQgmPMm/ee3yv3GyOe+Zij1v1WXtM8+
k7Z6pRcu2OUXrE/zUzVleayzxT+dLpsKsmJOwofT8n1aPzgcn1Q5TS5TJC3Cehn5
sxcPEiFr5mbEWjs/ZQIDAQAB
-----END PUBLIC KEY-----

[       310] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.3, via old OG: 10.0.0.3, seqno 5, tq 255, TTL 50, V 5, IDF 0) 
[       310]  
Sending INVITE message to new node
Received a PC REQUEST from new node
Sending/Issuing PC to new node
Added new node to neighbor list

Added new node to AL:
ID           : 778
IP ADDRESS   : 10.0.0.3
ROLE         : Authenticated Node
Subject Name : /CN=SP_1132445131/CN=1954927234
Public Key   :
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCwcQyf2udt1zq6Ieil8udZZi/c
vu1B7+3xSgu+Aa607LbuiblBWCFQu+vlX2pV3s1SiVzRxOYFzrWBXiMGfKvi0eA4
7P4aaeG2Te/Qzjf4yNBhWjojgH3WDYFN3zoqaASn+5T5auveFqh0esWl5eq5gcHd
PwraVlkcG8v7IeO7hwIDAQAB
-----END PUBLIC KEY-----

Broadcast new SIGN message to all neighbors
Generated New Current Key #1: 59:01:40:D1:51:74:37:5F:3D:3A:E5:05:F4:9C:2F:75
Receive SIGN message from neighbor - 10.0.0.3
Added new keystream to node already in neighbor list
[       880] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.55, via old OG: 10.0.0.55, seqno 4, tq 255, TTL 50, V 5, IDF 0) 
[       880]  
Sending INVITE message to new node
Received a PC REQUEST from new node
Sending/Issuing PC to new node
Added new node to neighbor list

Added new node to AL:
ID           : 14090
IP ADDRESS   : 10.0.0.55
ROLE         : Authenticated Node
Subject Name : /CN=SP_1132445131/CN=1677306717
Public Key   :
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCka5E3PkNee9z5PoBPkcDNi2gv
0rxMVU50oIIxm+vGN8VVBiHzVUyBjt0YpSursT5B7H7ksG8TJiFEHbPtD8/OiM2C
7naO9fSU0CI2u35caNyuU3s7nsvdXB7wDm/gNZEc1tCpd/uctq38ST3105chuB7+
eg7xJbSGehu9/pRq5wIDAQAB
-----END PUBLIC KEY-----

Send SIGN message to neighbor - 10.0.0.55
Receive SIGN message from neighbor - 10.0.0.55
Added new keystream to node already in neighbor list
[      1040]  
[      1040] ------------------ DEBUG ------------------ 
[      1040] Forward list 
[      1040]     10.0.0.4 at 1044 
[      1040] Originator list 
[      1040]   Originator  (#/255)         Nexthop [outgoingIF]:   Potential nexthops
[      1040] No batman nodes in range ... 
[      1040] ---------------------------------------------- END DEBUG 
[      1040]  
[      1050]  
[      1060] Sending own packet (originator 10.0.0.4, seqno 1, TQ 255, TTL 50, IDF off) on interface wlan0
[      1060] schedule_own_packet(): wlan0 
[      1060]  
[      1060] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 1, tq 255, TTL 50, V 5, IDF 0) 
[      1060] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      1060]  
[      1400] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.3, via old OG: 10.0.0.3, seqno 6, tq 255, TTL 50, V 5, IDF 0) 
MAC Extract did not match!
STATE = 11
[      1400]  
Sending my keystream request!
Receive SIGN message from neighbor - 10.0.0.3
Already received this keystream from this neighbor, maybe he does not have mine, sending now!
Send SIGN message to neighbor - 10.0.0.3
Added new keystream to node already in neighbor list
[      1930] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.55, via old OG: 10.0.0.55, seqno 5, tq 255, TTL 50, V 5, IDF 0) 
MAC Extract did not match!
STATE = 0
[      1930]  
[      2010]  
[      2020] Sending own packet (originator 10.0.0.4, seqno 2, TQ 255, TTL 50, IDF off) on interface wlan0
[      2020] schedule_own_packet(): wlan0 
[      2020]  
[      2020] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 2, tq 255, TTL 50, V 5, IDF 0) 
[      2020] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      2020]  
[      2140] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 2, tq 0, TTL 49, V 5, IDF 1) 
[      2140] Creating new originator: 10.0.0.55 
[      2140] count own bcast (is_my_orig): old = 0, [      2140] new = 1 
[      2140] Drop packet: originator packet from myself (via neighbour) 
[      2140] ------------------ DEBUG ------------------ 
[      2140] Forward list 
[      2140]     10.0.0.4 at 2947 
[      2140] Originator list 
[      2140]   Originator  (#/255)         Nexthop [outgoingIF]:   Potential nexthops
[      2140] No batman nodes in range ... 
[      2140] ---------------------------------------------- END DEBUG 
[      2140]  
[      2170] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 2, tq 0, TTL 49, V 5, IDF 1) 
[      2170] Creating new originator: 10.0.0.3 
[      2170] count own bcast (is_my_orig): old = 0, [      2170] new = 1 
[      2170] Drop packet: originator packet from myself (via neighbour) 
[      2170]  
[      2460] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.3, via old OG: 10.0.0.3, seqno 7, tq 255, TTL 50, V 5, IDF 0) 
[      2460] updating last_seqno: old 0, new 7 
[      2460] Creating new last-hop neighbour of originator
[      2460] bidirectional: orig = 10.0.0.3        neigh = 10.0.0.3        => own_bcast =  0, real recv =  0, local tq:   0, asym_penalty:   0, total tq:   0 
[      2460] schedule_forward_packet():  
[      2460] forwarding: tq_orig: 0, tq_avg: 0, tq_forw: 0, ttl_orig: 49, ttl_forw: 49 
[      2460] Forward packet: rebroadcast neighbour packet with direct link flag 
[      2460]  
[      2600]  
[      2610] Forwarding packet (originator 10.0.0.3, seqno 7, TQ 0, TTL 49, IDF on) on interface wlan0
[      2610]  
[      2610] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.3, via old OG: 10.0.0.3, seqno 7, tq 0, TTL 49, V 5, IDF 1) 
[      2610] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      2610]  
[      2940]  
[      2950]  
[      2960] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.55, via old OG: 10.0.0.55, seqno 6, tq 255, TTL 50, V 5, IDF 0) 
[      2960] updating last_seqno: old 0, new 6 
[      2960] Creating new last-hop neighbour of originator
[      2960] bidirectional: orig = 10.0.0.55       neigh = 10.0.0.55       => own_bcast =  0, real recv =  0, local tq:   0, asym_penalty:   0, total tq:   0 
[      2960] schedule_forward_packet():  
[      2960] forwarding: tq_orig: 0, tq_avg: 0, tq_forw: 0, ttl_orig: 49, ttl_forw: 49 
[      2960] Forward packet: rebroadcast neighbour packet with direct link flag 
[      2960] Sending own packet (originator 10.0.0.4, seqno 3, TQ 255, TTL 50, IDF off) on interface wlan0
[      2960] schedule_own_packet(): wlan0 
[      2960] count own bcast (schedule_own_packet): old = 1, [      2960] new = 1 
[      2960] count own bcast (schedule_own_packet): old = 1, [      2960] new = 1 
[      2960]  
[      2960] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 3, tq 255, TTL 50, V 5, IDF 0) 
[      2960] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      2960]  
[      3060]  
[      3060] Forwarding packet (originator 10.0.0.55, seqno 6, TQ 0, TTL 49, IDF on) on interface wlan0
[      3060]  
[      3060] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.55, via old OG: 10.0.0.55, seqno 6, tq 0, TTL 49, V 5, IDF 1) 
[      3060] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      3060]  
[      3060] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 3, tq 10, TTL 49, V 5, IDF 1) 
[      3060] count own bcast (is_my_orig): old = 1, [      3070] new = 2 
[      3070] Drop packet: originator packet from myself (via neighbour) 
[      3070]  
[      3100] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 3, tq 0, TTL 49, V 5, IDF 1) 
[      3100] count own bcast (is_my_orig): old = 1, [      3100] new = 2 
[      3100] Drop packet: originator packet from myself (via neighbour) 
[      3100]  
[      3560] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.3, via old OG: 10.0.0.3, seqno 8, tq 255, TTL 50, V 5, IDF 0) 
[      3560] updating last_seqno: old 7, new 8 
[      3560] bidirectional: orig = 10.0.0.3        neigh = 10.0.0.3        => own_bcast =  1, real recv =  1, local tq: 255, asym_penalty:  12, total tq:  12 
[      3560] update_originator(): Searching and updating originator entry of received packet,  
[      3560] Updating existing last-hop neighbour of originator
[      3560] update_routes() 
[      3560] Route to 10.0.0.3 via 10.0.0.3
[      3560] Adding new route
[      3560] Adding route to 10.0.0.3 via 0.0.0.0 (table 66 - wlan0)
[      3560] schedule_forward_packet():  
[      3560] forwarding: tq_orig: 12, tq_avg: 12, tq_forw: 11, ttl_orig: 49, ttl_forw: 49 
[      3560] Forward packet: rebroadcast neighbour packet with direct link flag 
[      3560] ------------------ DEBUG ------------------ 
[      3560] Forward list 
[      3560]     10.0.0.3 at 3626 
[      3560]     10.0.0.4 at 3952 
[      3560] Originator list 
[      3560]   Originator  (#/255)         Nexthop [outgoingIF]:   Potential nexthops
[      3560]        10.0.0.3 ( 12)        10.0.0.3 [     wlan0], last_valid: 3560: 
[      3560]         10.0.0.3 ( 12) 
[      3560] ---------------------------------------------- END DEBUG 
[      3560]  
[      3630]  
[      3640] Forwarding packet (originator 10.0.0.3, seqno 8, TQ 10, TTL 49, IDF on) on interface wlan0
[      3640]  
[      3640] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.3, via old OG: 10.0.0.3, seqno 8, tq 10, TTL 49, V 5, IDF 1) 
[      3640] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      3640]  
[      3950]  
[      3950]  
[      3950]  
[      3960]  
[      3960] Sending own packet (originator 10.0.0.4, seqno 4, TQ 255, TTL 50, IDF off) on interface wlan0
[      3960] schedule_own_packet(): wlan0 
[      3960] count own bcast (schedule_own_packet): old = 2, [      3960] new = 2 
[      3960] count own bcast (schedule_own_packet): old = 2, [      3960] new = 2 
[      3960]  
[      3960] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 4, tq 255, TTL 50, V 5, IDF 0) 
[      3960] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      3960]  
[      4050] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.55, via old OG: 10.0.0.55, seqno 7, tq 255, TTL 50, V 5, IDF 0) 
[      4050] updating last_seqno: old 6, new 7 
[      4050] bidirectional: orig = 10.0.0.55       neigh = 10.0.0.55       => own_bcast =  1, real recv =  1, local tq: 255, asym_penalty:  12, total tq:  12 
[      4050] update_originator(): Searching and updating originator entry of received packet,  
[      4050] Updating existing last-hop neighbour of originator
[      4050] update_routes() 
[      4050] Route to 10.0.0.55 via 10.0.0.55
[      4050] Adding new route
[      4050] Adding route to 10.0.0.55 via 0.0.0.0 (table 66 - wlan0)
[      4050] schedule_forward_packet():  
[      4050] forwarding: tq_orig: 12, tq_avg: 12, tq_forw: 11, ttl_orig: 49, ttl_forw: 49 
[      4050] Forward packet: rebroadcast neighbour packet with direct link flag 
[      4050]  
[      4140] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 4, tq 22, TTL 49, V 5, IDF 1) 
[      4140] count own bcast (is_my_orig): old = 2, [      4140] new = 3 
[      4140] Drop packet: originator packet from myself (via neighbour) 
[      4140]  
[      4180]  
[      4190] Forwarding packet (originator 10.0.0.55, seqno 7, TQ 10, TTL 49, IDF on) on interface wlan0
[      4190]  
[      4190] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.55, via old OG: 10.0.0.55, seqno 7, tq 10, TTL 49, V 5, IDF 1) 
[      4190] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      4190]  
[      4610] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.3, via old OG: 10.0.0.3, seqno 9, tq 255, TTL 50, V 5, IDF 0) 
[      4610] updating last_seqno: old 8, new 9 
[      4610] bidirectional: orig = 10.0.0.3        neigh = 10.0.0.3        => own_bcast =  2, real recv =  2, local tq: 255, asym_penalty:  24, total tq:  24 
[      4610] update_originator(): Searching and updating originator entry of received packet,  
[      4610] Updating existing last-hop neighbour of originator
[      4610] update_routes() 
[      4610] schedule_forward_packet():  
[      4610] forwarding: tq_orig: 24, tq_avg: 18, tq_forw: 23, ttl_orig: 49, ttl_forw: 49 
[      4610] Forward packet: rebroadcast neighbour packet with direct link flag 
[      4610] ------------------ DEBUG ------------------ 
[      4610] Forward list 
[      4610]     10.0.0.3 at 4662 
[      4610]     10.0.0.4 at 5034 
[      4610] Originator list 
[      4610]   Originator  (#/255)         Nexthop [outgoingIF]:   Potential nexthops
[      4610]        10.0.0.3 ( 18)        10.0.0.3 [     wlan0], last_valid: 4610: 
[      4610]         10.0.0.3 ( 18) 
[      4610]       10.0.0.55 ( 12)       10.0.0.55 [     wlan0], last_valid: 4050: 
[      4610]        10.0.0.55 ( 12) 
[      4610] ---------------------------------------------- END DEBUG
