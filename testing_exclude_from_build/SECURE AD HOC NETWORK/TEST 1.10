root@batman4:~/secure-ad-hoc-network# batmand --role sp -d 4 wlan0
Secure Ad Hoc Network extension enabled
Interface activated: wlan0
Using interface wlan0 with address 10.0.0.4 and broadcast address 10.0.0.255
B.A.T.M.A.N. 0.3.2 (compatibility version 5)
debug level: 4
Attempting to seed the PRNG...
Successfully seeded the PRNG with 1024 bytes from /dev/urandom.
[         0] schedule_own_packet(): wlan0 
[         0]  
Generated Master Key: 65:14:C6:4B:10:1B:5A:52:B1:A9:F4:F6:78:E4:ED:B5
..................++++++
.....++++++

Added new node to AL:
ID           : 1034
IP ADDRESS   : 10.0.0.4
ROLE         : Authenticated Node
Subject Name : SP_1018438197
Public Key   :
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDvHTwk/2AVQxLOI3WJ9bEPqqQt
T+LjNA3JqfQAs+zT9aMEVMDycBdOiOsukQLSyTAkIVk8xfzeGrYSmvcbdvmgXm7E
/LCBdhcG5VDGsG7Jlncvnu8cszCxKIaPUdMRaoUxP54vmAL8I/jpo6CmNQekPhHf
36HYPxmHDTaWhWA6TwIDAQAB
-----END PUBLIC KEY-----

[       640] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.55, via old OG: 10.0.0.55, seqno 3, tq 255, TTL 50, V 5, IDF 0) 
[       640]  
Sending INVITE message to new node
Received a PC REQUEST from new node
Sending/Issuing PC to new node
Added new node to neighbor list

Added new node to AL:
ID           : 14090
IP ADDRESS   : 10.0.0.55
ROLE         : Authenticated Node
Subject Name : /CN=SP_1018438197/CN=458903168
Public Key   :
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCyysMTFwbYHtbfn86KPMpqAzoQ
3tJzgAxE6xoa3EXiSNSwhXYsLW6PI4aWapcmzH7PzpwhnJJnckSdkELdskBJVxIH
r0N3j5fwSl/nCa50r4veImR4YVWUBm2zVCYb7QTGi358ZoeKB7fzb+ICXMCIwj6Z
9dfnXdj+PSk10TgVIwIDAQAB
-----END PUBLIC KEY-----

Broadcast new SIGN message to all neighbors
Generated New Current Key #1: 1C:79:E8:C0:FC:A1:92:BC:2E:98:21:B3:9F:DE:A5:AA
Receive SIGN message from neighbor - 10.0.0.55
Added new keystream to node already in neighbor list
[       740] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.3, via old OG: 10.0.0.3, seqno 4, tq 255, TTL 50, V 5, IDF 0) 
[       740]  
Sending INVITE message to new node
Received a PC REQUEST from new node
Sending/Issuing PC to new node
Added new node to neighbor list

Added new node to AL:
ID           : 778
IP ADDRESS   : 10.0.0.3
ROLE         : Authenticated Node
Subject Name : /CN=SP_1018438197/CN=1297353602
Public Key   :
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC5VUGcedH8cNq5mavWkLdCmbkk
aG4X6507yWtcjIYTN7Ri62JsXX0VastyBFEWl8llrXNrqXrcv+5iXcezldwVgwfv
+I9Wa8+DWXwtHMygofZB2qLEUIX9FZNKeCc9CgqejOUMK2aR2Y9YiPBzWIxEVReE
Mhg8WmJlgcBzI/0cUQIDAQAB
-----END PUBLIC KEY-----

Send SIGN message to neighbor - 10.0.0.3
Receive SIGN message from neighbor - 10.0.0.3
Added new keystream to node already in neighbor list
[       920]  
[       930]  
[       940] Sending own packet (originator 10.0.0.4, seqno 1, TQ 255, TTL 50, IDF off) on interface wlan0
[       940] schedule_own_packet(): wlan0 
[       940]  
[       940] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 1, tq 255, TTL 50, V 5, IDF 0) 
[       940] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[       940]  
[      1570] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.55, via old OG: 10.0.0.55, seqno 4, tq 255, TTL 50, V 5, IDF 0) 
MAC Extract did not match!
[      1570] ------------------ DEBUG ------------------ 
[      1570] Forward list 
[      1570]     10.0.0.4 at 1916 
[      1570] Originator list 
[      1570]   Originator  (#/255)         Nexthop [outgoingIF]:   Potential nexthops
[      1570] No batman nodes in range ... 
[      1570] ---------------------------------------------- END DEBUG 
STATE = 11
[      1570]  
Sending my keystream request!
Receive SIGN message from neighbor - 10.0.0.55
Already received this keystream from this neighbor, maybe he does not have mine, sending now!
Send SIGN message to neighbor - 10.0.0.55
Added new keystream to node already in neighbor list
[      1700] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.3, via old OG: 10.0.0.3, seqno 5, tq 255, TTL 50, V 5, IDF 0) 
MAC Extract did not match!
[      1700]  
Sending my keystream request!
Receive SIGN message from neighbor - 10.0.0.3
Already received this keystream from this neighbor, maybe he does not have mine, sending now!
Send SIGN message to neighbor - 10.0.0.3
Added new keystream to node already in neighbor list
STATE = 0
[      1920]  
[      1930] Sending own packet (originator 10.0.0.4, seqno 2, TQ 255, TTL 50, IDF off) on interface wlan0
[      1930] schedule_own_packet(): wlan0 
[      1930]  
[      1930] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 2, tq 255, TTL 50, V 5, IDF 0) 
[      1930] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      1930]  
[      2020] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 2, tq 0, TTL 49, V 5, IDF 1) 
[      2020] Creating new originator: 10.0.0.55 
[      2020] count own bcast (is_my_orig): old = 0, [      2020] new = 1 
[      2020] Drop packet: originator packet from myself (via neighbour) 
[      2020]  
[      2090] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 2, tq 0, TTL 49, V 5, IDF 1) 
[      2090] Creating new originator: 10.0.0.3 
[      2090] count own bcast (is_my_orig): old = 0, [      2090] new = 1 
[      2090] Drop packet: originator packet from myself (via neighbour) 
[      2090]  
[      2490] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.55, via old OG: 10.0.0.55, seqno 5, tq 255, TTL 50, V 5, IDF 0) 
[      2490] updating last_seqno: old 0, new 5 
[      2490] Creating new last-hop neighbour of originator
[      2490] bidirectional: orig = 10.0.0.55       neigh = 10.0.0.55       => own_bcast =  0, real recv =  0, local tq:   0, asym_penalty:   0, total tq:   0 
[      2490] schedule_forward_packet():  
[      2490] forwarding: tq_orig: 0, tq_avg: 0, tq_forw: 0, ttl_orig: 49, ttl_forw: 49 
[      2490] Forward packet: rebroadcast neighbour packet with direct link flag 
[      2490]  
[      2630] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.3, via old OG: 10.0.0.3, seqno 6, tq 255, TTL 50, V 5, IDF 0) 
[      2630] updating last_seqno: old 0, new 6 
[      2630] Creating new last-hop neighbour of originator
[      2630] bidirectional: orig = 10.0.0.3        neigh = 10.0.0.3        => own_bcast =  0, real recv =  0, local tq:   0, asym_penalty:   0, total tq:   0 
[      2630] schedule_forward_packet():  
[      2630] forwarding: tq_orig: 0, tq_avg: 0, tq_forw: 0, ttl_orig: 49, ttl_forw: 49 
[      2630] Forward packet: rebroadcast neighbour packet with direct link flag 
[      2630] ------------------ DEBUG ------------------ 
[      2630] Forward list 
[      2630]     10.0.0.55 at 2634 
[      2630]     10.0.0.3 at 2738 
[      2630]     10.0.0.4 at 2992 
[      2630] Originator list 
[      2630]   Originator  (#/255)         Nexthop [outgoingIF]:   Potential nexthops
[      2630] No batman nodes in range ... 
[      2630] ---------------------------------------------- END DEBUG 
[      2630]  
[      2630]  
[      2640]  
[      2650] Forwarding packet (originator 10.0.0.55, seqno 5, TQ 0, TTL 49, IDF on) on interface wlan0
[      2650]  
[      2650] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.55, via old OG: 10.0.0.55, seqno 5, tq 0, TTL 49, V 5, IDF 1) 
[      2650] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      2650]  
[      2740]  
[      2740] Forwarding packet (originator 10.0.0.3, seqno 6, TQ 0, TTL 49, IDF on) on interface wlan0
[      2740]  
[      2740] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.3, via old OG: 10.0.0.3, seqno 6, tq 0, TTL 49, V 5, IDF 1) 
[      2750] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      2750]  
[      2990]  
[      2990]  
[      2990]  
[      3000]  
[      3000] Sending own packet (originator 10.0.0.4, seqno 3, TQ 255, TTL 50, IDF off) on interface wlan0
[      3000] schedule_own_packet(): wlan0 
[      3000] count own bcast (schedule_own_packet): old = 1, [      3000] new = 1 
[      3000] count own bcast (schedule_own_packet): old = 1, [      3000] new = 1 
[      3000]  
[      3000] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 3, tq 255, TTL 50, V 5, IDF 0) 
[      3000] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      3000]  
[      3090] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 3, tq 10, TTL 49, V 5, IDF 1) 
[      3090] count own bcast (is_my_orig): old = 1, [      3090] new = 2 
[      3090] Drop packet: originator packet from myself (via neighbour) 
[      3090]  
[      3160] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 3, tq 10, TTL 49, V 5, IDF 1) 
[      3160] count own bcast (is_my_orig): old = 1, [      3160] new = 2 
[      3160] Drop packet: originator packet from myself (via neighbour) 
[      3160]  
[      3540] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.55, via old OG: 10.0.0.55, seqno 6, tq 255, TTL 50, V 5, IDF 0) 
[      3540] updating last_seqno: old 5, new 6 
[      3540] bidirectional: orig = 10.0.0.55       neigh = 10.0.0.55       => own_bcast =  1, real recv =  1, local tq: 255, asym_penalty:  12, total tq:  12 
[      3540] update_originator(): Searching and updating originator entry of received packet,  
[      3540] Updating existing last-hop neighbour of originator
[      3540] update_routes() 
[      3540] Route to 10.0.0.55 via 10.0.0.55
[      3540] Adding new route
[      3540] Adding route to 10.0.0.55 via 0.0.0.0 (table 66 - wlan0)
[      3540] schedule_forward_packet():  
[      3540] forwarding: tq_orig: 12, tq_avg: 12, tq_forw: 11, ttl_orig: 49, ttl_forw: 49 
[      3540] Forward packet: rebroadcast neighbour packet with direct link flag 
[      3540]  
[      3590] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.3, via old OG: 10.0.0.3, seqno 7, tq 255, TTL 50, V 5, IDF 0) 
[      3590] updating last_seqno: old 6, new 7 
[      3590] bidirectional: orig = 10.0.0.3        neigh = 10.0.0.3        => own_bcast =  1, real recv =  1, local tq: 255, asym_penalty:  12, total tq:  12 
[      3590] update_originator(): Searching and updating originator entry of received packet,  
[      3590] Updating existing last-hop neighbour of originator
[      3590] update_routes() 
[      3590] Route to 10.0.0.3 via 10.0.0.3
[      3590] Adding new route
[      3590] Adding route to 10.0.0.3 via 0.0.0.0 (table 66 - wlan0)
[      3590] schedule_forward_packet():  
[      3590] forwarding: tq_orig: 12, tq_avg: 12, tq_forw: 11, ttl_orig: 49, ttl_forw: 49 
[      3590] Forward packet: rebroadcast neighbour packet with direct link flag 
[      3590]  
[      3660]  
[      3670] Forwarding packet (originator 10.0.0.3, seqno 7, TQ 10, TTL 49, IDF on) on interface wlan0
[      3670] ------------------ DEBUG ------------------ 
[      3670] Forward list 
[      3670]     10.0.0.55 at 3672 
[      3670]     10.0.0.4 at 4078 
[      3670] Originator list 
[      3670]   Originator  (#/255)         Nexthop [outgoingIF]:   Potential nexthops
[      3670]        10.0.0.3 ( 12)        10.0.0.3 [     wlan0], last_valid: 3590: 
[      3670]         10.0.0.3 ( 12) 
[      3670]       10.0.0.55 ( 12)       10.0.0.55 [     wlan0], last_valid: 3540: 
[      3670]        10.0.0.55 ( 12) 
[      3670] ---------------------------------------------- END DEBUG
