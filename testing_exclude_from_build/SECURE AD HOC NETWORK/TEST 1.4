root@batman4:~/secure-ad-hoc-network# batmand --role sp -d 4 wlan0
Secure Ad Hoc Network extension enabled
Interface activated: wlan0
Using interface wlan0 with address 10.0.0.4 and broadcast address 10.0.0.255
B.A.T.M.A.N. 0.3.2 (compatibility version 5)
debug level: 4
Attempting to seed the PRNG...
Successfully seeded the PRNG with 1024 bytes from /dev/urandom.
[        10] schedule_own_packet(): wlan0 
[        10]  
Generated Master Key: 80:11:D1:E6:75:A0:72:E3:C1:A6:03:C3:39:25:D8:75
...............................................++++++
...++++++

Added new node to AL:
ID           : 1034
IP ADDRESS   : 10.0.0.4
ROLE         : Authenticated Node
Subject Name : SP_1241772651
Public Key   :
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC7jiPMZ0jfRHAZqP4a8HsdyaN5
qbeaqRY0svXemd0+mpaNkt4ypYVTSqwhBHzcFtKLyC4Sr14vHi7fE48bJQiY7VFG
7id/z9KQuufU/QlioEwOCYJbn5pjADl1S87jw52pg+tT6xZ7BAkD4blkR73rAzKp
C65vyQdv0d+oXwqg0wIDAQAB
-----END PUBLIC KEY-----

[       760] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.3, via old OG: 10.0.0.3, seqno 5, tq 255, TTL 50, V 5, IDF 0) 
[       760]  
Sending INVITE message to new node
Received a PC REQUEST from new node
Sending/Issuing PC to new node
Added new node to neighbor list

Added new node to AL:
ID           : 778
IP ADDRESS   : 10.0.0.3
ROLE         : Authenticated Node
Subject Name : /CN=SP_1241772651/CN=1533911026
Public Key   :
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCft0yG2FZEy/gbfo3S0eZ4aOKe
0UK/QEJcmf3sD1Jer+ZeWyEd0hkGH0A9pk9R/XLZo00C/tuWrcKY74iyvK8XXiHa
bhPx/oaaRIIqoGxQZWrtE3Skzdddtp/NPr2SbkK9SZATC0cOsUExW7BVrsbZzmwV
ErKKaRY2MLCvMsPPeQIDAQAB
-----END PUBLIC KEY-----

Broadcast new SIGN message to all neighbors
Generated New Current Key #1: 4C:AA:40:06:BB:D8:50:2A:B1:F7:C8:67:1B:E7:FD:A9
Receive SIGN message from neighbor - 10.0.0.3
Added new keystream to node already in neighbor list
[       860] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.55, via old OG: 10.0.0.55, seqno 4, tq 255, TTL 50, V 5, IDF 0) 
[       860]  
Sending INVITE message to new node
Received a PC REQUEST from new node
Sending/Issuing PC to new node
STATE = 10
[       950]  
[       960] Sending own packet (originator 10.0.0.4, seqno 1, TQ 255, TTL 50, IDF off) on interface wlan0
[       960] schedule_own_packet(): wlan0 
[       960]  
[       960] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 1, tq 255, TTL 50, V 5, IDF 0) 
[       960] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[       960]  
Added new node to neighbor list

Added new node to AL:
ID           : 14090
IP ADDRESS   : 10.0.0.55
ROLE         : Authenticated Node
Subject Name : /CN=SP_1241772651/CN=781172874
Public Key   :
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCqZVFQr1aftkZ6hp9o/2hB6JQM
/cmMaWUQrqsMjVZdq7EX6GBzzg6P2xEKZX+STcHMeZhZKRz4e9s4eR19JP++8YIk
OrlGhwI3lLmN5fKjgHaAQUO8BWp8zfrOgl+XwGECvoDjWqzbCd2mJG0jyOPG0PQY
aT/25b+ricweh1PMiQIDAQAB
-----END PUBLIC KEY-----

Send SIGN message to neighbor - 10.0.0.55
Receive SIGN message from neighbor - 10.0.0.55
Added new keystream to node already in neighbor list
[      1680] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.3, via old OG: 10.0.0.3, seqno 6, tq 255, TTL 50, V 5, IDF 0) 
MAC Extract did not match!
[      1680] ------------------ DEBUG ------------------ 
[      1680] Forward list 
[      1680]     10.0.0.4 at 2032 
[      1680] Originator list 
[      1680]   Originator  (#/255)         Nexthop [outgoingIF]:   Potential nexthops
[      1680] No batman nodes in range ... 
[      1680] ---------------------------------------------- END DEBUG 
STATE = 11
[      1680]  
Sending my keystream request!
Receive SIGN message from neighbor - 10.0.0.3
Already received this keystream from this neighbor, maybe he does not have mine, sending now!
Send SIGN message to neighbor - 10.0.0.3
Added new keystream to node already in neighbor list
[      1860] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.55, via old OG: 10.0.0.55, seqno 5, tq 255, TTL 50, V 5, IDF 0) 
MAC Extract did not match!
[      1860]  
Sending my keystream request!
Receive SIGN message from neighbor - 10.0.0.55
Already received this keystream from this neighbor, maybe he does not have mine, sending now!
Send SIGN message to neighbor - 10.0.0.55
Added new keystream to node already in neighbor list
STATE = 0
[      2040]  
[      2050] Sending own packet (originator 10.0.0.4, seqno 2, TQ 255, TTL 50, IDF off) on interface wlan0
[      2050] schedule_own_packet(): wlan0 
[      2050]  
[      2050] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 2, tq 255, TTL 50, V 5, IDF 0) 
[      2050] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      2050]  
[      2130] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 2, tq 0, TTL 49, V 5, IDF 1) 
[      2130] Creating new originator: 10.0.0.55 
[      2140] count own bcast (is_my_orig): old = 0, [      2140] new = 1 
[      2140] Drop packet: originator packet from myself (via neighbour) 
[      2140]  
[      2210] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 2, tq 0, TTL 49, V 5, IDF 1) 
[      2210] Creating new originator: 10.0.0.3 
[      2210] count own bcast (is_my_orig): old = 0, [      2210] new = 1 
[      2210] Drop packet: originator packet from myself (via neighbour) 
[      2210]  
[      2720] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.3, via old OG: 10.0.0.3, seqno 7, tq 255, TTL 50, V 5, IDF 0) 
[      2720] updating last_seqno: old 0, new 7 
[      2720] Creating new last-hop neighbour of originator
[      2720] bidirectional: orig = 10.0.0.3        neigh = 10.0.0.3        => own_bcast =  0, real recv =  0, local tq:   0, asym_penalty:   0, total tq:   0 
[      2720] schedule_forward_packet():  
[      2720] forwarding: tq_orig: 0, tq_avg: 0, tq_forw: 0, ttl_orig: 49, ttl_forw: 49 
[      2720] Forward packet: rebroadcast neighbour packet with direct link flag 
[      2720] ------------------ DEBUG ------------------ 
[      2720] Forward list 
[      2720]     10.0.0.3 at 2773 
[      2720]     10.0.0.4 at 2994 
[      2720] Originator list 
[      2720]   Originator  (#/255)         Nexthop [outgoingIF]:   Potential nexthops
[      2720] No batman nodes in range ... 
[      2720] ---------------------------------------------- END DEBUG 
[      2720]  
[      2780]  
[      2790] Forwarding packet (originator 10.0.0.3, seqno 7, TQ 0, TTL 49, IDF on) on interface wlan0
[      2790]  
[      2790] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.3, via old OG: 10.0.0.3, seqno 7, tq 0, TTL 49, V 5, IDF 1) 
[      2790] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      2790]  
[      2920] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.55, via old OG: 10.0.0.55, seqno 6, tq 255, TTL 50, V 5, IDF 0) 
[      2920] updating last_seqno: old 0, new 6 
[      2920] Creating new last-hop neighbour of originator
[      2920] bidirectional: orig = 10.0.0.55       neigh = 10.0.0.55       => own_bcast =  0, real recv =  0, local tq:   0, asym_penalty:   0, total tq:   0 
[      2920] schedule_forward_packet():  
[      2920] forwarding: tq_orig: 0, tq_avg: 0, tq_forw: 0, ttl_orig: 49, ttl_forw: 49 
[      2920] Forward packet: rebroadcast neighbour packet with direct link flag 
[      2920]  
[      2990]  
[      2990]  
[      3000]  
[      3010] Sending own packet (originator 10.0.0.4, seqno 3, TQ 255, TTL 50, IDF off) on interface wlan0
[      3010] schedule_own_packet(): wlan0 
[      3010] count own bcast (schedule_own_packet): old = 1, [      3010] new = 1 
[      3010] count own bcast (schedule_own_packet): old = 1, [      3010] new = 1 
[      3010]  
[      3010] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 3, tq 255, TTL 50, V 5, IDF 0) 
[      3010] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      3010]  
[      3040]  
[      3040]  
[      3040]  
[      3040]  
[      3040]  
[      3040]  
[      3040]  
[      3050]  
[      3060] Forwarding packet (originator 10.0.0.55, seqno 6, TQ 0, TTL 49, IDF on) on interface wlan0
[      3060]  
[      3060] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.55, via old OG: 10.0.0.55, seqno 6, tq 0, TTL 49, V 5, IDF 1) 
[      3060] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      3060]  
[      3090] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 3, tq 10, TTL 49, V 5, IDF 1) 
[      3090] count own bcast (is_my_orig): old = 1, [      3090] new = 2 
[      3090] Drop packet: originator packet from myself (via neighbour) 
[      3090]  
[      3090] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 3, tq 0, TTL 49, V 5, IDF 1) 
[      3090] count own bcast (is_my_orig): old = 1, [      3090] new = 2 
[      3090] Drop packet: originator packet from myself (via neighbour) 
[      3090]  
[      3810] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.3, via old OG: 10.0.0.3, seqno 8, tq 255, TTL 50, V 5, IDF 0) 
[      3810] updating last_seqno: old 7, new 8 
[      3810] bidirectional: orig = 10.0.0.3        neigh = 10.0.0.3        => own_bcast =  1, real recv =  1, local tq: 255, asym_penalty:  12, total tq:  12 
[      3810] update_originator(): Searching and updating originator entry of received packet,  
[      3810] Updating existing last-hop neighbour of originator
[      3810] update_routes() 
[      3810] Route to 10.0.0.3 via 10.0.0.3
[      3810] Adding new route
[      3810] Adding route to 10.0.0.3 via 0.0.0.0 (table 66 - wlan0)
[      3810] schedule_forward_packet():  
[      3810] forwarding: tq_orig: 12, tq_avg: 12, tq_forw: 11, ttl_orig: 49, ttl_forw: 49 
[      3810] Forward packet: rebroadcast neighbour packet with direct link flag 
[      3810] ------------------ DEBUG ------------------ 
[      3810] Forward list 
[      3810]     10.0.0.3 at 3940 
[      3810]     10.0.0.4 at 4105 
[      3810] Originator list 
[      3810]   Originator  (#/255)         Nexthop [outgoingIF]:   Potential nexthops
[      3810]        10.0.0.3 ( 12)        10.0.0.3 [     wlan0], last_valid: 3810: 
[      3810]         10.0.0.3 ( 12) 
[      3810] ---------------------------------------------- END DEBUG 
[      3810]  
[      3940]  
[      3950] Forwarding packet (originator 10.0.0.3, seqno 8, TQ 10, TTL 49, IDF on) on interface wlan0
[      3950]  
[      3950] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.3, via old OG: 10.0.0.3, seqno 8, tq 10, TTL 49, V 5, IDF 1) 
[      3950] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      3950]  
[      3960] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.55, via old OG: 10.0.0.55, seqno 7, tq 255, TTL 50, V 5, IDF 0) 
[      3960] updating last_seqno: old 6, new 7 
[      3960] bidirectional: orig = 10.0.0.55       neigh = 10.0.0.55       => own_bcast =  1, real recv =  1, local tq: 255, asym_penalty:  12, total tq:  12 
[      3960] update_originator(): Searching and updating originator entry of received packet,  
[      3960] Updating existing last-hop neighbour of originator
[      3960] update_routes() 
[      3960] Route to 10.0.0.55 via 10.0.0.55
[      3960] Adding new route
[      3960] Adding route to 10.0.0.55 via 0.0.0.0 (table 66 - wlan0)
[      3960] schedule_forward_packet():  
[      3960] forwarding: tq_orig: 12, tq_avg: 12, tq_forw: 11, ttl_orig: 49, ttl_forw: 49 
[      3960] Forward packet: rebroadcast neighbour packet with direct link flag 
[      3960]  
[      4010]  
[      4010]  
[      4010]  
[      4010]  
[      4020]  
[      4020] Forwarding packet (originator 10.0.0.55, seqno 7, TQ 10, TTL 49, IDF on) on interface wlan0
[      4020]  
[      4020] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.55, via old OG: 10.0.0.55, seqno 7, tq 10, TTL 49, V 5, IDF 1) 
[      4020] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      4020]  
[      4110]  
[      4120] Sending own packet (originator 10.0.0.4, seqno 4, TQ 255, TTL 50, IDF off) on interface wlan0
[      4120] schedule_own_packet(): wlan0 
[      4120] count own bcast (schedule_own_packet): old = 2, [      4120] new = 2 
[      4120] count own bcast (schedule_own_packet): old = 2, [      4120] new = 2 
[      4120]  
[      4120] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 4, tq 255, TTL 50, V 5, IDF 0) 
[      4120] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      4120]  
[      4220] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 4, tq 22, TTL 49, V 5, IDF 1) 
[      4220] count own bcast (is_my_orig): old = 2, [      4220] new = 3 
[      4220] Drop packet: originator packet from myself (via neighbour) 
[      4220]  
[      4250] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 4, tq 22, TTL 49, V 5, IDF 1) 
[      4250] count own bcast (is_my_orig): old = 2, [      4250] new = 3 
[      4250] Drop packet: originator packet from myself (via neighbour) 
[      4250]  
[      4790] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.3, via old OG: 10.0.0.3, seqno 9, tq 255, TTL 50, V 5, IDF 0) 
[      4790] updating last_seqno: old 8, new 9 
[      4790] bidirectional: orig = 10.0.0.3        neigh = 10.0.0.3        => own_bcast =  2, real recv =  2, local tq: 255, asym_penalty:  24, total tq:  24 
[      4790] update_originator(): Searching and updating originator entry of received packet,  
[      4790] Updating existing last-hop neighbour of originator
[      4790] update_routes() 
[      4790] schedule_forward_packet():  
[      4790] forwarding: tq_orig: 24, tq_avg: 18, tq_forw: 23, ttl_orig: 49, ttl_forw: 49 
[      4790] Forward packet: rebroadcast neighbour packet with direct link flag 
[      4790]  
[      4860]  
[      4870] Forwarding packet (originator 10.0.0.3, seqno 9, TQ 22, TTL 49, IDF on) on interface wlan0
[      4870] ------------------ DEBUG ------------------ 
[      4870] Forward list 
[      4870]     10.0.0.4 at 5188 
[      4870] Originator list 
[      4870]   Originator  (#/255)         Nexthop [outgoingIF]:   Potential nexthops
[      4870]        10.0.0.3 ( 18)        10.0.0.3 [     wlan0], last_valid: 4790: 
[      4870]         10.0.0.3 ( 18) 
[      4870]       10.0.0.55 ( 12)       10.0.0.55 [     wlan0], last_valid: 3960: 
[      4870]        10.0.0.55 ( 12) 
[      4870] ---------------------------------------------- END DEBUG
