root@batman4:~/secure-ad-hoc-network# batmand --role sp -d 4 wlan0
Secure Ad Hoc Network extension enabled
Interface activated: wlan0
Using interface wlan0 with address 10.0.0.4 and broadcast address 10.0.0.255
B.A.T.M.A.N. 0.3.2 (compatibility version 5)
debug level: 4
Attempting to seed the PRNG...
Successfully seeded the PRNG with 1024 bytes from /dev/urandom.
[        10] schedule_own_packet(): wlan0 
[        10]  
Generated Master Key: C4:9C:CC:63:0F:F5:1F:77:23:5C:BA:92:A3:08:32:7C
..................++++++
.....................++++++

Added new node to AL:
ID           : 1034
IP ADDRESS   : 10.0.0.4
ROLE         : Authenticated Node
Subject Name : SP_1359969585
Public Key   :
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDCLWRwODadUJIpjmeSxllKNN5a
hjU1Pe8O29Qk1s/aTE6UNi1X2lFHYo2pHP4DV8IXoY7CD45kDBI+zFtbQG5NU7t4
v/Px9kU9gPz/z3c6cxEYq02lxwDkUhA+tXvKwhv/OUSvedNFIDVE/Q2KA+lWbJj/
5VvtscFmGqtDIIRnRQIDAQAB
-----END PUBLIC KEY-----

[       330] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.55, via old OG: 10.0.0.55, seqno 13, tq 255, TTL 50, V 5, IDF 0) 
[       330]  
Sending INVITE message to new node
Received a PC REQUEST from new node
Sending/Issuing PC to new node
Added new node to neighbor list

Added new node to AL:
ID           : 14090
IP ADDRESS   : 10.0.0.55
ROLE         : Authenticated Node
Subject Name : /CN=SP_1359969585/CN=967761018
Public Key   :
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC369f5tOySqhUuLG0aJbwtcToS
A9AsV9z9FgFmQ1QIDYfo60abGw8tfPF/H/imQ0tgbpWUDSTazrKNHepvBn+sKm7h
p6d+7b/3QSo/wHZOfnY2yPJpqQa/wgEyQfcygF2uopOSQd7GBruKR7TXc7wHg8nb
YsRPfcHNXXvX0ZL+WwIDAQAB
-----END PUBLIC KEY-----

Broadcast new SIGN message to all neighbors
Generated New Current Key #1: 5B:C0:A1:3D:7E:B0:D3:1D:36:2F:FA:AB:60:51:5D:8F
Receive SIGN message from neighbor - 10.0.0.55
Added new keystream to node already in neighbor list
[       850] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.3, via old OG: 10.0.0.3, seqno 15, tq 255, TTL 50, V 5, IDF 0) 
[       850]  
Sending INVITE message to new node
Received a PC REQUEST from new node
Sending/Issuing PC to new node
Added new node to neighbor list

Added new node to AL:
ID           : 778
IP ADDRESS   : 10.0.0.3
ROLE         : Authenticated Node
Subject Name : /CN=SP_1359969585/CN=209066799
Public Key   :
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDJUwB37ObMo1K6bWX8qKuvdGbX
/18DHZeciLY4j0XCvowZHq6eHSxulf2a7eZpKLf9FkEAqRm+p4uYBNxrj4einJsT
uyAX3K1ePXDNZzvisus1o+zRvwfkiXrqZYACRZV8Q5HN7PN2gLs/QZUxRbD422P5
vkfp7KgnNzglhSA2aQIDAQAB
-----END PUBLIC KEY-----

Send SIGN message to neighbor - 10.0.0.3
Receive SIGN message from neighbor - 10.0.0.3
Added new keystream to node already in neighbor list
[       950]  
[       960] Sending own packet (originator 10.0.0.4, seqno 1, TQ 255, TTL 50, IDF off) on interface wlan0
[       960] schedule_own_packet(): wlan0 
[       960]  
[       960] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 1, tq 255, TTL 50, V 5, IDF 0) 
[       960] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[       960]  
[      1270] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.55, via old OG: 10.0.0.55, seqno 14, tq 255, TTL 50, V 5, IDF 0) 
MAC Extract did not match!
[      1270] ------------------ DEBUG ------------------ 
[      1270] Forward list 
[      1270]     10.0.0.4 at 2000 
[      1270] Originator list 
[      1270]   Originator  (#/255)         Nexthop [outgoingIF]:   Potential nexthops
[      1270] No batman nodes in range ... 
[      1270] ---------------------------------------------- END DEBUG 
STATE = 11
[      1270]  
Sending my keystream request!
Receive SIGN message from neighbor - 10.0.0.55
Already received this keystream from this neighbor, maybe he does not have mine, sending now!
Send SIGN message to neighbor - 10.0.0.55
Added new keystream to node already in neighbor list
[      1800] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.3, via old OG: 10.0.0.3, seqno 16, tq 255, TTL 50, V 5, IDF 0) 
MAC Extract did not match!
[      1800]  
Sending my keystream request!
Receive SIGN message from neighbor - 10.0.0.3
Already received this keystream from this neighbor, maybe he does not have mine, sending now!
Send SIGN message to neighbor - 10.0.0.3
Added new keystream to node already in neighbor list
STATE = 0
[      2000]  
[      2010] Sending own packet (originator 10.0.0.4, seqno 2, TQ 255, TTL 50, IDF off) on interface wlan0
[      2010] schedule_own_packet(): wlan0 
[      2010]  
[      2010] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 2, tq 255, TTL 50, V 5, IDF 0) 
[      2010] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      2010]  
[      2100] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 2, tq 0, TTL 49, V 5, IDF 1) 
[      2100] Creating new originator: 10.0.0.3 
[      2100] count own bcast (is_my_orig): old = 0, [      2100] new = 1 
[      2100] Drop packet: originator packet from myself (via neighbour) 
[      2100]  
[      2200] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.55, via old OG: 10.0.0.55, seqno 15, tq 255, TTL 50, V 5, IDF 0) 
[      2200] Creating new originator: 10.0.0.55 
[      2200] updating last_seqno: old 0, new 15 
[      2200] Creating new last-hop neighbour of originator
[      2200] bidirectional: orig = 10.0.0.55       neigh = 10.0.0.55       => own_bcast =  0, real recv =  0, local tq:   0, asym_penalty:   0, total tq:   0 
[      2200] schedule_forward_packet():  
[      2200] forwarding: tq_orig: 0, tq_avg: 0, tq_forw: 0, ttl_orig: 49, ttl_forw: 49 
[      2200] Forward packet: rebroadcast neighbour packet with direct link flag 
[      2200]  
[      2320]  
[      2330] Forwarding packet (originator 10.0.0.55, seqno 15, TQ 0, TTL 49, IDF on) on interface wlan0
[      2330] ------------------ DEBUG ------------------ 
[      2330] Forward list 
[      2330]     10.0.0.4 at 2971 
[      2330] Originator list 
[      2330]   Originator  (#/255)         Nexthop [outgoingIF]:   Potential nexthops
[      2330] No batman nodes in range ... 
[      2330] ---------------------------------------------- END DEBUG 
[      2330]  
[      2330] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.55, via old OG: 10.0.0.55, seqno 15, tq 0, TTL 49, V 5, IDF 1) 
[      2330] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      2330]  
[      2810] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.3, via old OG: 10.0.0.3, seqno 17, tq 255, TTL 50, V 5, IDF 0) 
[      2810] updating last_seqno: old 0, new 17 
[      2810] Creating new last-hop neighbour of originator
[      2810] bidirectional: orig = 10.0.0.3        neigh = 10.0.0.3        => own_bcast =  0, real recv =  0, local tq:   0, asym_penalty:   0, total tq:   0 
[      2810] schedule_forward_packet():  
[      2810] forwarding: tq_orig: 0, tq_avg: 0, tq_forw: 0, ttl_orig: 49, ttl_forw: 49 
[      2810] Forward packet: rebroadcast neighbour packet with direct link flag 
[      2810]  
[      2900]  
[      2910]  
[      2910] Forwarding packet (originator 10.0.0.3, seqno 17, TQ 0, TTL 49, IDF on) on interface wlan0
[      2910]  
[      2910] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.3, via old OG: 10.0.0.3, seqno 17, tq 0, TTL 49, V 5, IDF 1) 
[      2910] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      2910]  
[      2970]  
[      2980]  
[      2990] Sending own packet (originator 10.0.0.4, seqno 3, TQ 255, TTL 50, IDF off) on interface wlan0
[      2990] schedule_own_packet(): wlan0 
[      2990] count own bcast (schedule_own_packet): old = 1, [      2990] new = 1 
[      2990] count own bcast (schedule_own_packet): old = 0, [      2990] new = 0 
[      2990]  
[      2990] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 3, tq 255, TTL 50, V 5, IDF 0) 
[      2990] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      2990]  
[      3090] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 3, tq 10, TTL 49, V 5, IDF 1) 
[      3090] count own bcast (is_my_orig): old = 1, [      3090] new = 2 
[      3090] Drop packet: originator packet from myself (via neighbour) 
[      3090]  
[      3140] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.55, via old OG: 10.0.0.55, seqno 16, tq 255, TTL 50, V 5, IDF 0) 
[      3140] updating last_seqno: old 15, new 16 
[      3140] bidirectional: orig = 10.0.0.55       neigh = 10.0.0.55       => own_bcast =  0, real recv =  1, local tq:   0, asym_penalty:  12, total tq:   0 
[      3140] schedule_forward_packet():  
[      3140] forwarding: tq_orig: 0, tq_avg: 0, tq_forw: 0, ttl_orig: 49, ttl_forw: 49 
[      3140] Forward packet: rebroadcast neighbour packet with direct link flag 
[      3140]  
[      3140] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 3, tq 10, TTL 49, V 5, IDF 1) 
[      3140] count own bcast (is_my_orig): old = 0, [      3140] new = 1 
[      3140] Drop packet: originator packet from myself (via neighbour) 
[      3140]  
[      3280]  
[      3290] Forwarding packet (originator 10.0.0.55, seqno 16, TQ 0, TTL 49, IDF on) on interface wlan0
[      3290]  
[      3290] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.55, via old OG: 10.0.0.55, seqno 16, tq 0, TTL 49, V 5, IDF 1) 
[      3290] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      3290]  
[      3890] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.3, via old OG: 10.0.0.3, seqno 18, tq 255, TTL 50, V 5, IDF 0) 
[      3890] updating last_seqno: old 17, new 18 
[      3890] bidirectional: orig = 10.0.0.3        neigh = 10.0.0.3        => own_bcast =  1, real recv =  1, local tq: 255, asym_penalty:  12, total tq:  12 
[      3890] update_originator(): Searching and updating originator entry of received packet,  
[      3890] Updating existing last-hop neighbour of originator
[      3890] update_routes() 
[      3890] Route to 10.0.0.3 via 10.0.0.3
[      3890] Adding new route
[      3890] Adding route to 10.0.0.3 via 0.0.0.0 (table 66 - wlan0)
[      3890] schedule_forward_packet():  
[      3890] forwarding: tq_orig: 12, tq_avg: 12, tq_forw: 11, ttl_orig: 49, ttl_forw: 49 
[      3890] Forward packet: rebroadcast neighbour packet with direct link flag 
[      3890] ------------------ DEBUG ------------------ 
[      3890] Forward list 
[      3890]     10.0.0.3 at 3958 
[      3890]     10.0.0.4 at 4058 
[      3890] Originator list 
[      3890]   Originator  (#/255)         Nexthop [outgoingIF]:   Potential nexthops
[      3890]        10.0.0.3 ( 12)        10.0.0.3 [     wlan0], last_valid: 3890: 
[      3890]         10.0.0.3 ( 12) 
[      3890] ---------------------------------------------- END DEBUG 
[      3890]  
[      3950]  
[      3960]  
[      3970] Forwarding packet (originator 10.0.0.3, seqno 18, TQ 10, TTL 49, IDF on) on interface wlan0
[      3970]  
[      3970] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.3, via old OG: 10.0.0.3, seqno 18, tq 10, TTL 49, V 5, IDF 1) 
[      3970] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      3970]  
[      4060]  
[      4070] Sending own packet (originator 10.0.0.4, seqno 4, TQ 255, TTL 50, IDF off) on interface wlan0
[      4070] schedule_own_packet(): wlan0 
[      4070] count own bcast (schedule_own_packet): old = 2, [      4070] new = 2 
[      4070] count own bcast (schedule_own_packet): old = 1, [      4070] new = 1 
[      4070]  
[      4070] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 4, tq 255, TTL 50, V 5, IDF 0) 
[      4070] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      4070]  
[      4100] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.55, via old OG: 10.0.0.55, seqno 17, tq 255, TTL 50, V 5, IDF 0) 
[      4100] updating last_seqno: old 16, new 17 
[      4100] bidirectional: orig = 10.0.0.55       neigh = 10.0.0.55       => own_bcast =  1, real recv =  2, local tq: 127, asym_penalty:  24, total tq:  11 
[      4100] update_originator(): Searching and updating originator entry of received packet,  
[      4100] Updating existing last-hop neighbour of originator
[      4100] update_routes() 
[      4100] Route to 10.0.0.55 via 10.0.0.55
[      4100] Adding new route
[      4100] Adding route to 10.0.0.55 via 0.0.0.0 (table 66 - wlan0)
[      4100] schedule_forward_packet():  
[      4100] forwarding: tq_orig: 11, tq_avg: 11, tq_forw: 10, ttl_orig: 49, ttl_forw: 49 
[      4100] Forward packet: rebroadcast neighbour packet with direct link flag 
[      4100]  
[      4170]  
[      4170] Forwarding packet (originator 10.0.0.55, seqno 17, TQ 9, TTL 49, IDF on) on interface wlan0
[      4170]  
[      4170] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.55, via old OG: 10.0.0.55, seqno 17, tq 9, TTL 49, V 5, IDF 1) 
[      4170] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      4170]  
[      4210] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 4, tq 22, TTL 49, V 5, IDF 1) 
[      4210] count own bcast (is_my_orig): old = 2, [      4210] new = 3 
[      4210] Drop packet: originator packet from myself (via neighbour) 
[      4210]  
[      4210] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 4, tq 22, TTL 49, V 5, IDF 1) 
[      4210] count own bcast (is_my_orig): old = 1, [      4210] new = 2 
[      4210] Drop packet: originator packet from myself (via neighbour) 
[      4210]  
[      4990] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.3, via old OG: 10.0.0.3, seqno 19, tq 255, TTL 50, V 5, IDF 0) 
[      4990] updating last_seqno: old 18, new 19 
[      4990] bidirectional: orig = 10.0.0.3        neigh = 10.0.0.3        => own_bcast =  2, real recv =  2, local tq: 255, asym_penalty:  24, total tq:  24 
[      4990] update_originator(): Searching and updating originator entry of received packet,  
[      4990] Updating existing last-hop neighbour of originator
[      4990] update_routes() 
[      4990] schedule_forward_packet():  
[      4990] forwarding: tq_orig: 24, tq_avg: 18, tq_forw: 23, ttl_orig: 49, ttl_forw: 49 
[      4990] Forward packet: rebroadcast neighbour packet with direct link flag 
[      4990] ------------------ DEBUG ------------------ 
[      4990] Forward list 
[      4990]     10.0.0.4 at 5039 
[      4990]     10.0.0.3 at 5093 
[      4990] Originator list 
[      4990]   Originator  (#/255)         Nexthop [outgoingIF]:   Potential nexthops
[      4990]        10.0.0.3 ( 18)        10.0.0.3 [     wlan0], last_valid: 4990: 
[      4990]         10.0.0.3 ( 18) 
[      4990]       10.0.0.55 ( 11)       10.0.0.55 [     wlan0], last_valid: 4100: 
[      4990]        10.0.0.55 ( 11) 
[      4990] ---------------------------------------------- END DEBUG
