root@batman4:~/secure-ad-hoc-network# batmand --role sp -d 4 wlan0
Secure Ad Hoc Network extension enabled
Interface activated: wlan0
Using interface wlan0 with address 10.0.0.4 and broadcast address 10.0.0.255
B.A.T.M.A.N. 0.3.2 (compatibility version 5)
debug level: 4
Attempting to seed the PRNG...
Successfully seeded the PRNG with 1024 bytes from /dev/urandom.
[         0] schedule_own_packet(): wlan0 
[         0]  
Generated Master Key: 7C:64:57:E6:B6:CF:B0:32:E5:B6:A8:F4:4F:27:33:BA
.++++++
..........................++++++

Added new node to AL:
ID           : 1034
IP ADDRESS   : 10.0.0.4
ROLE         : Authenticated Node
Subject Name : SP_1635823152
Public Key   :
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC0Tit62Il0fVUcVf9wyGS52z84
zAMhkumh7abR+A+WZlXuPhBn9daUYioR55sOSM5HR+GvFjdCGfSdcq3QuDX2eiiR
ibGA/+BwQxn0/5GhKh1/jwohDSiADsjk/4jGo/9kIuleluTl+7/DsbTFB3MZXu5P
tbTuyDOeFyYagDSrhwIDAQAB
-----END PUBLIC KEY-----

[       690] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.55, via old OG: 10.0.0.55, seqno 6, tq 255, TTL 50, V 5, IDF 0) 
[       690]  
Sending INVITE message to new node
Received a PC REQUEST from new node
Sending/Issuing PC to new node
Added new node to neighbor list

Added new node to AL:
ID           : 14090
IP ADDRESS   : 10.0.0.55
ROLE         : Authenticated Node
Subject Name : /CN=SP_1635823152/CN=2090790729
Public Key   :
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDZPXNsfNbpKibh99s0vJLx7ls+
qwheEeDRS8QNYaU3qjqS09SPRtaoVPOOolxJA1d5SWuwAoCaOtiaBu9ODocLuru8
PI9FdDDFN3oEF6RPZQfTOMXdTcxi9icRAwIg9oEvPtkTRJqtbtEqlBZi00beOrAq
DMSDyuL7l9UuwuLN0QIDAQAB
-----END PUBLIC KEY-----

Broadcast new SIGN message to all neighbors
Generated New Current Key #1: 26:41:BD:5F:D9:F6:36:BF:AE:5A:DC:D7:46:75:F5:4C
Receive SIGN message from neighbor - 10.0.0.55
Added new keystream to node already in neighbor list
[       940] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.3, via old OG: 10.0.0.3, seqno 8, tq 255, TTL 50, V 5, IDF 0) 
[       940]  
Sending INVITE message to new node
Received a PC REQUEST from new node
Sending/Issuing PC to new node
Added new node to neighbor list

Added new node to AL:
ID           : 778
IP ADDRESS   : 10.0.0.3
ROLE         : Authenticated Node
Subject Name : /CN=SP_1635823152/CN=1575946387
Public Key   :
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDkPTUsQhcTKlBjx9gQDR4GOS7H
VK3KsANc9KsPeFXVzdpIKVAb7XCkeWxxjkZGwc2dCGDedFRv8e33szkTmkGLxZNS
QpPyBseWKPe8TjCx/5/K8pkbyqcf5grh3CAbzjlQC/8L6Dfv7oTc8ideMYQyU3/n
s8Jk82jzW2+zwvbNgQIDAQAB
-----END PUBLIC KEY-----

Send SIGN message to neighbor - 10.0.0.3
Receive SIGN message from neighbor - 10.0.0.3
Added new keystream to node already in neighbor list
[      1020]  
[      1030] Sending own packet (originator 10.0.0.4, seqno 1, TQ 255, TTL 50, IDF off) on interface wlan0
[      1030] schedule_own_packet(): wlan0 
[      1030] ------------------ DEBUG ------------------ 
[      1030] Forward list 
[      1030]     10.0.0.4 at 2108 
[      1030] Originator list 
[      1030]   Originator  (#/255)         Nexthop [outgoingIF]:   Potential nexthops
[      1030] No batman nodes in range ... 
[      1030] ---------------------------------------------- END DEBUG 
[      1030]  
[      1030] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 1, tq 255, TTL 50, V 5, IDF 0) 
[      1030] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      1030]  
[      1660] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.55, via old OG: 10.0.0.55, seqno 7, tq 255, TTL 50, V 5, IDF 0) 
MAC Extract did not match!
STATE = 11
[      1660]  
Sending my keystream request!
Receive SIGN message from neighbor - 10.0.0.55
Already received this keystream from this neighbor, maybe he does not have mine, sending now!
Send SIGN message to neighbor - 10.0.0.55
Added new keystream to node already in neighbor list
[      1970] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.3, via old OG: 10.0.0.3, seqno 9, tq 255, TTL 50, V 5, IDF 0) 
MAC Extract did not match!
STATE = 0
[      1970]  
[      2110]  
[      2120] Sending own packet (originator 10.0.0.4, seqno 2, TQ 255, TTL 50, IDF off) on interface wlan0
[      2120] schedule_own_packet(): wlan0 
[      2120] ------------------ DEBUG ------------------ 
[      2120] Forward list 
[      2120]     10.0.0.4 at 3062 
[      2120] Originator list 
[      2120]   Originator  (#/255)         Nexthop [outgoingIF]:   Potential nexthops
[      2120] No batman nodes in range ... 
[      2120] ---------------------------------------------- END DEBUG 
[      2120]  
[      2120] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 2, tq 255, TTL 50, V 5, IDF 0) 
[      2120] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      2120]  
[      2210] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 2, tq 0, TTL 49, V 5, IDF 1) 
[      2210] Creating new originator: 10.0.0.3 
[      2210] count own bcast (is_my_orig): old = 0, [      2210] new = 1 
[      2210] Drop packet: originator packet from myself (via neighbour) 
[      2210]  
[      2240] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 2, tq 0, TTL 49, V 5, IDF 1) 
[      2240] Creating new originator: 10.0.0.55 
[      2240] count own bcast (is_my_orig): old = 0, [      2240] new = 1 
[      2240] Drop packet: originator packet from myself (via neighbour) 
[      2240]  
[      2760] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.55, via old OG: 10.0.0.55, seqno 8, tq 255, TTL 50, V 5, IDF 0) 
[      2760] updating last_seqno: old 0, new 8 
[      2760] Creating new last-hop neighbour of originator
[      2760] bidirectional: orig = 10.0.0.55       neigh = 10.0.0.55       => own_bcast =  0, real recv =  0, local tq:   0, asym_penalty:   0, total tq:   0 
[      2760] schedule_forward_packet():  
[      2760] forwarding: tq_orig: 0, tq_avg: 0, tq_forw: 0, ttl_orig: 49, ttl_forw: 49 
[      2760] Forward packet: rebroadcast neighbour packet with direct link flag 
[      2760]  
[      2900] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.3, via old OG: 10.0.0.3, seqno 10, tq 255, TTL 50, V 5, IDF 0) 
[      2900] updating last_seqno: old 0, new 10 
[      2900] Creating new last-hop neighbour of originator
[      2900] bidirectional: orig = 10.0.0.3        neigh = 10.0.0.3        => own_bcast =  0, real recv =  0, local tq:   0, asym_penalty:   0, total tq:   0 
[      2900] schedule_forward_packet():  
[      2900] forwarding: tq_orig: 0, tq_avg: 0, tq_forw: 0, ttl_orig: 49, ttl_forw: 49 
[      2900] Forward packet: rebroadcast neighbour packet with direct link flag 
[      2900]  
[      2910]  
[      2920] Forwarding packet (originator 10.0.0.55, seqno 8, TQ 0, TTL 49, IDF on) on interface wlan0
[      2920]  
[      2920] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.55, via old OG: 10.0.0.55, seqno 8, tq 0, TTL 49, V 5, IDF 1) 
[      2920] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      2920]  
[      2980]  
[      2990]  
[      2990] Forwarding packet (originator 10.0.0.3, seqno 10, TQ 0, TTL 49, IDF on) on interface wlan0
[      2990]  
[      2990] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.3, via old OG: 10.0.0.3, seqno 10, tq 0, TTL 49, V 5, IDF 1) 
[      2990] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      2990]  
[      3070]  
[      3080] Sending own packet (originator 10.0.0.4, seqno 3, TQ 255, TTL 50, IDF off) on interface wlan0
[      3080] schedule_own_packet(): wlan0 
[      3080] count own bcast (schedule_own_packet): old = 1, [      3080] new = 1 
[      3080] count own bcast (schedule_own_packet): old = 1, [      3080] new = 1 
[      3080]  
[      3080] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 3, tq 255, TTL 50, V 5, IDF 0) 
[      3080] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      3080]  
[      3170] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 3, tq 10, TTL 49, V 5, IDF 1) 
[      3170] count own bcast (is_my_orig): old = 1, [      3170] new = 2 
[      3170] Drop packet: originator packet from myself (via neighbour) 
[      3170] ------------------ DEBUG ------------------ 
[      3170] Forward list 
[      3170]     10.0.0.4 at 4115 
[      3170] Originator list 
[      3170]   Originator  (#/255)         Nexthop [outgoingIF]:   Potential nexthops
[      3170] No batman nodes in range ... 
[      3170] ---------------------------------------------- END DEBUG 
[      3170]  
[      3220] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 3, tq 10, TTL 49, V 5, IDF 1) 
[      3220] count own bcast (is_my_orig): old = 1, [      3220] new = 2 
[      3220] Drop packet: originator packet from myself (via neighbour) 
[      3220]  
[      3690] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.55, via old OG: 10.0.0.55, seqno 9, tq 255, TTL 50, V 5, IDF 0) 
[      3690] updating last_seqno: old 8, new 9 
[      3690] bidirectional: orig = 10.0.0.55       neigh = 10.0.0.55       => own_bcast =  1, real recv =  1, local tq: 255, asym_penalty:  12, total tq:  12 
[      3690] update_originator(): Searching and updating originator entry of received packet,  
[      3690] Updating existing last-hop neighbour of originator
[      3690] update_routes() 
[      3690] Route to 10.0.0.55 via 10.0.0.55
[      3690] Adding new route
[      3690] Adding route to 10.0.0.55 via 0.0.0.0 (table 66 - wlan0)
[      3690] schedule_forward_packet():  
[      3690] forwarding: tq_orig: 12, tq_avg: 12, tq_forw: 11, ttl_orig: 49, ttl_forw: 49 
[      3690] Forward packet: rebroadcast neighbour packet with direct link flag 
[      3690]  
[      3820]  
[      3830]  
[      3840] Forwarding packet (originator 10.0.0.55, seqno 9, TQ 10, TTL 49, IDF on) on interface wlan0
[      3840]  
[      3840] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.55, via old OG: 10.0.0.55, seqno 9, tq 10, TTL 49, V 5, IDF 1) 
[      3840] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      3840]  
[      3980] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.3, via old OG: 10.0.0.3, seqno 11, tq 255, TTL 50, V 5, IDF 0) 
[      3980] updating last_seqno: old 10, new 11 
[      3980] bidirectional: orig = 10.0.0.3        neigh = 10.0.0.3        => own_bcast =  1, real recv =  1, local tq: 255, asym_penalty:  12, total tq:  12 
[      3980] update_originator(): Searching and updating originator entry of received packet,  
[      3980] Updating existing last-hop neighbour of originator
[      3980] update_routes() 
[      3980] Route to 10.0.0.3 via 10.0.0.3
[      3980] Adding new route
[      3980] Adding route to 10.0.0.3 via 0.0.0.0 (table 66 - wlan0)
[      3980] schedule_forward_packet():  
[      3980] forwarding: tq_orig: 12, tq_avg: 12, tq_forw: 11, ttl_orig: 49, ttl_forw: 49 
[      3980] Forward packet: rebroadcast neighbour packet with direct link flag 
[      3980]  
[      4090]  
[      4100] Forwarding packet (originator 10.0.0.3, seqno 11, TQ 10, TTL 49, IDF on) on interface wlan0
[      4100]  
[      4100] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.3, via old OG: 10.0.0.3, seqno 11, tq 10, TTL 49, V 5, IDF 1) 
[      4100] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      4100]  
[      4110]  
[      4120]  
[      4130] Sending own packet (originator 10.0.0.4, seqno 4, TQ 255, TTL 50, IDF off) on interface wlan0
[      4130] schedule_own_packet(): wlan0 
[      4130] count own bcast (schedule_own_packet): old = 2, [      4130] new = 2 
[      4130] count own bcast (schedule_own_packet): old = 2, [      4130] new = 2 
[      4130]  
[      4130] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 4, tq 255, TTL 50, V 5, IDF 0) 
[      4130] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      4130]  
[      4260] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 4, tq 22, TTL 49, V 5, IDF 1) 
[      4260] count own bcast (is_my_orig): old = 2, [      4260] new = 3 
[      4260] Drop packet: originator packet from myself (via neighbour) 
[      4260] ------------------ DEBUG ------------------ 
[      4260] Forward list 
[      4260]     10.0.0.4 at 5165 
[      4260] Originator list 
[      4260]   Originator  (#/255)         Nexthop [outgoingIF]:   Potential nexthops
[      4260]        10.0.0.3 ( 12)        10.0.0.3 [     wlan0], last_valid: 3980: 
[      4260]         10.0.0.3 ( 12) 
[      4260]       10.0.0.55 ( 12)       10.0.0.55 [     wlan0], last_valid: 3690: 
[      4260]        10.0.0.55 ( 12) 
[      4260] ---------------------------------------------- END DEBUG
