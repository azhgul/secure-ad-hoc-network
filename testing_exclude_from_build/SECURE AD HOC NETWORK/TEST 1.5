root@batman4:~/secure-ad-hoc-network# batmand --role sp -d 4 wlan0
Secure Ad Hoc Network extension enabled
Interface activated: wlan0
Using interface wlan0 with address 10.0.0.4 and broadcast address 10.0.0.255
B.A.T.M.A.N. 0.3.2 (compatibility version 5)
debug level: 4
Attempting to seed the PRNG...
Successfully seeded the PRNG with 1024 bytes from /dev/urandom.
[         0] schedule_own_packet(): wlan0 
[         0]  
Generated Master Key: 26:F4:47:68:5E:AA:2F:47:D7:47:1D:B0:8C:16:AF:4A
...................++++++
.............++++++

Added new node to AL:
ID           : 1034
IP ADDRESS   : 10.0.0.4
ROLE         : Authenticated Node
Subject Name : SP_848949537
Public Key   :
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQClphiVVs6/l0jNZK6U2r9AOcIs
hnjSqdgRMiqpMAzfHyNhEzLHYzxI4nE6VhDMAe8LAs/XgrzEIuZbYHqmEb8g0wVb
vcvX2jcS548Ph6hNXI40c7lReMw1YZVAhjC/wHTcU903kRWbZkmoxVqI3aupUhfg
nRa+ViPGQEmUF4hkBwIDAQAB
-----END PUBLIC KEY-----

[       270] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.55, via old OG: 10.0.0.55, seqno 3, tq 255, TTL 50, V 5, IDF 0) 
[       270]  
Sending INVITE message to new node
Received a PC REQUEST from new node
Sending/Issuing PC to new node
Added new node to neighbor list

Added new node to AL:
ID           : 14090
IP ADDRESS   : 10.0.0.55
ROLE         : Authenticated Node
Subject Name : /CN=SP_848949537/CN=1807174585
Public Key   :
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCyNCdGFaYY0ffVGFVL7StQxVh8
pR2B9dW1CNLMcHjXCJmFFsBlTeIr5Ue8dS4KUkslrR4J54LD9KqnfWry6nQRdixc
7QgZbHAzMIg05jB8QMbxjGFm/nCutcMc5LgYImLqrrjfj0p3PJYT5mupwUnPfMnW
Jny9WKvSbjACUJ6ouQIDAQAB
-----END PUBLIC KEY-----

Broadcast new SIGN message to all neighbors
Generated New Current Key #1: 2A:39:AF:4D:1B:31:9A:AD:C4:1D:C2:1A:31:89:19:3B
Receive SIGN message from neighbor - 10.0.0.55
Added new keystream to node already in neighbor list
[       700] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.3, via old OG: 10.0.0.3, seqno 5, tq 255, TTL 50, V 5, IDF 0) 
[       700]  
Sending INVITE message to new node
Received a PC REQUEST from new node
Sending/Issuing PC to new node
Added new node to neighbor list

Added new node to AL:
ID           : 778
IP ADDRESS   : 10.0.0.3
ROLE         : Authenticated Node
Subject Name : /CN=SP_848949537/CN=595744661
Public Key   :
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDgZEnU7L40X1VaUi8Uwd/LpW3z
bfOC53AoQPpNcz8OWVuuyP2RIE/aXXPKTCesubqc2fokG2OZHDOy+WwQ/cmOg8H1
wCtLx/T8vLe/60lli7pM9wtEaqzvXLettD+KA8pVhlKaXH/mLzN3QHvTLmZokc/w
bwdN/0DxRHReXzrVPwIDAQAB
-----END PUBLIC KEY-----

Send SIGN message to neighbor - 10.0.0.3
Receive SIGN message from neighbor - 10.0.0.3
Added new keystream to node already in neighbor list
[       940]  
[       950]  
[       960] Sending own packet (originator 10.0.0.4, seqno 1, TQ 255, TTL 50, IDF off) on interface wlan0
[       960] schedule_own_packet(): wlan0 
[       960]  
[       960] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 1, tq 255, TTL 50, V 5, IDF 0) 
[       960] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[       960]  
[      1300] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.55, via old OG: 10.0.0.55, seqno 4, tq 255, TTL 50, V 5, IDF 0) 
MAC Extract did not match!
[      1300] ------------------ DEBUG ------------------ 
[      1300] Forward list 
[      1300]     10.0.0.4 at 2000 
[      1300] Originator list 
[      1300]   Originator  (#/255)         Nexthop [outgoingIF]:   Potential nexthops
[      1300] No batman nodes in range ... 
[      1300] ---------------------------------------------- END DEBUG 
STATE = 11
[      1300]  
Sending my keystream request!
Receive SIGN message from neighbor - 10.0.0.55
Already received this keystream from this neighbor, maybe he does not have mine, sending now!
Send SIGN message to neighbor - 10.0.0.55
Added new keystream to node already in neighbor list
[      1680] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.3, via old OG: 10.0.0.3, seqno 6, tq 255, TTL 50, V 5, IDF 0) 
MAC Extract did not match!
STATE = 0
[      1680]  
[      2000]  
[      2010] Sending own packet (originator 10.0.0.4, seqno 2, TQ 255, TTL 50, IDF off) on interface wlan0
[      2010] schedule_own_packet(): wlan0 
[      2010]  
[      2010] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 2, tq 255, TTL 50, V 5, IDF 0) 
[      2010] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      2010]  
[      2110] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 2, tq 0, TTL 49, V 5, IDF 1) 
[      2110] Creating new originator: 10.0.0.3 
[      2110] count own bcast (is_my_orig): old = 0, [      2110] new = 1 
[      2110] Drop packet: originator packet from myself (via neighbour) 
[      2110]  
[      2120] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 2, tq 0, TTL 49, V 5, IDF 1) 
[      2120] Creating new originator: 10.0.0.55 
[      2120] count own bcast (is_my_orig): old = 0, [      2120] new = 1 
[      2120] Drop packet: originator packet from myself (via neighbour) 
[      2120]  
[      2280] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.55, via old OG: 10.0.0.55, seqno 5, tq 255, TTL 50, V 5, IDF 0) 
[      2280] updating last_seqno: old 0, new 5 
[      2280] Creating new last-hop neighbour of originator
[      2280] bidirectional: orig = 10.0.0.55       neigh = 10.0.0.55       => own_bcast =  0, real recv =  0, local tq:   0, asym_penalty:   0, total tq:   0 
[      2280] schedule_forward_packet():  
[      2280] forwarding: tq_orig: 0, tq_avg: 0, tq_forw: 0, ttl_orig: 49, ttl_forw: 49 
[      2280] Forward packet: rebroadcast neighbour packet with direct link flag 
[      2280]  
[      2430]  
[      2440] Forwarding packet (originator 10.0.0.55, seqno 5, TQ 0, TTL 49, IDF on) on interface wlan0
[      2440] ------------------ DEBUG ------------------ 
[      2440] Forward list 
[      2440]     10.0.0.4 at 2921 
[      2440] Originator list 
[      2440]   Originator  (#/255)         Nexthop [outgoingIF]:   Potential nexthops
[      2440] No batman nodes in range ... 
[      2440] ---------------------------------------------- END DEBUG 
[      2440]  
[      2440] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.55, via old OG: 10.0.0.55, seqno 5, tq 0, TTL 49, V 5, IDF 1) 
[      2440] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      2440]  
[      2620] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.3, via old OG: 10.0.0.3, seqno 7, tq 255, TTL 50, V 5, IDF 0) 
[      2620] updating last_seqno: old 0, new 7 
[      2620] Creating new last-hop neighbour of originator
[      2620] bidirectional: orig = 10.0.0.3        neigh = 10.0.0.3        => own_bcast =  0, real recv =  0, local tq:   0, asym_penalty:   0, total tq:   0 
[      2620] schedule_forward_packet():  
[      2620] forwarding: tq_orig: 0, tq_avg: 0, tq_forw: 0, ttl_orig: 49, ttl_forw: 49 
[      2620] Forward packet: rebroadcast neighbour packet with direct link flag 
[      2620]  
[      2750]  
[      2760]  
[      2760] Forwarding packet (originator 10.0.0.3, seqno 7, TQ 0, TTL 49, IDF on) on interface wlan0
[      2760]  
[      2760] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.3, via old OG: 10.0.0.3, seqno 7, tq 0, TTL 49, V 5, IDF 1) 
[      2760] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      2760]  
[      2930]  
[      2940] Sending own packet (originator 10.0.0.4, seqno 3, TQ 255, TTL 50, IDF off) on interface wlan0
[      2940] schedule_own_packet(): wlan0 
[      2940] count own bcast (schedule_own_packet): old = 1, [      2940] new = 1 
[      2940] count own bcast (schedule_own_packet): old = 1, [      2940] new = 1 
[      2940]  
[      2940] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 3, tq 255, TTL 50, V 5, IDF 0) 
[      2940] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      2940]  
[      3040] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 3, tq 10, TTL 49, V 5, IDF 1) 
[      3040] count own bcast (is_my_orig): old = 1, [      3040] new = 2 
[      3040] Drop packet: originator packet from myself (via neighbour) 
[      3040]  
[      3080] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 3, tq 10, TTL 49, V 5, IDF 1) 
[      3080] count own bcast (is_my_orig): old = 1, [      3080] new = 2 
[      3080] Drop packet: originator packet from myself (via neighbour) 
[      3080]  
[      3290] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.55, via old OG: 10.0.0.55, seqno 6, tq 255, TTL 50, V 5, IDF 0) 
[      3290] updating last_seqno: old 5, new 6 
[      3290] bidirectional: orig = 10.0.0.55       neigh = 10.0.0.55       => own_bcast =  1, real recv =  1, local tq: 255, asym_penalty:  12, total tq:  12 
[      3290] update_originator(): Searching and updating originator entry of received packet,  
[      3290] Updating existing last-hop neighbour of originator
[      3290] update_routes() 
[      3290] Route to 10.0.0.55 via 10.0.0.55
[      3290] Adding new route
[      3290] Adding route to 10.0.0.55 via 0.0.0.0 (table 66 - wlan0)
[      3290] schedule_forward_packet():  
[      3290] forwarding: tq_orig: 12, tq_avg: 12, tq_forw: 11, ttl_orig: 49, ttl_forw: 49 
[      3290] Forward packet: rebroadcast neighbour packet with direct link flag 
[      3290]  
[      3430]  
[      3440]  
[      3450] Forwarding packet (originator 10.0.0.55, seqno 6, TQ 10, TTL 49, IDF on) on interface wlan0
[      3450] ------------------ DEBUG ------------------ 
[      3450] Forward list 
[      3450]     10.0.0.4 at 3879 
[      3450] Originator list 
[      3450]   Originator  (#/255)         Nexthop [outgoingIF]:   Potential nexthops
[      3450]       10.0.0.55 ( 12)       10.0.0.55 [     wlan0], last_valid: 3290: 
[      3450]        10.0.0.55 ( 12) 
[      3450] ---------------------------------------------- END DEBUG 
[      3450]  
[      3450] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.55, via old OG: 10.0.0.55, seqno 6, tq 10, TTL 49, V 5, IDF 1) 
[      3450] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      3450]  
[      3580] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.3, via old OG: 10.0.0.3, seqno 8, tq 255, TTL 50, V 5, IDF 0) 
[      3580] updating last_seqno: old 7, new 8 
[      3580] bidirectional: orig = 10.0.0.3        neigh = 10.0.0.3        => own_bcast =  1, real recv =  1, local tq: 255, asym_penalty:  12, total tq:  12 
[      3580] update_originator(): Searching and updating originator entry of received packet,  
[      3580] Updating existing last-hop neighbour of originator
[      3580] update_routes() 
[      3580] Route to 10.0.0.3 via 10.0.0.3
[      3580] Adding new route
[      3580] Adding route to 10.0.0.3 via 0.0.0.0 (table 66 - wlan0)
[      3580] schedule_forward_packet():  
[      3580] forwarding: tq_orig: 12, tq_avg: 12, tq_forw: 11, ttl_orig: 49, ttl_forw: 49 
[      3580] Forward packet: rebroadcast neighbour packet with direct link flag 
[      3580]  
[      3690]  
[      3690]  
[      3700]  
[      3700] Forwarding packet (originator 10.0.0.3, seqno 8, TQ 10, TTL 49, IDF on) on interface wlan0
[      3700]  
[      3700] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.3, via old OG: 10.0.0.3, seqno 8, tq 10, TTL 49, V 5, IDF 1) 
[      3700] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      3700]  
[      3880]  
[      3890] Sending own packet (originator 10.0.0.4, seqno 4, TQ 255, TTL 50, IDF off) on interface wlan0
[      3890] schedule_own_packet(): wlan0 
[      3890] count own bcast (schedule_own_packet): old = 2, [      3890] new = 2 
[      3890] count own bcast (schedule_own_packet): old = 2, [      3890] new = 2 
[      3890]  
[      3890] Received BATMAN packet via NB: 10.0.0.4, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 4, tq 255, TTL 50, V 5, IDF 0) 
[      3890] Drop packet: received my own broadcast (sender: 10.0.0.4) 
[      3890]  
[      3990] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 4, tq 22, TTL 49, V 5, IDF 1) 
[      3990] count own bcast (is_my_orig): old = 2, [      3990] new = 3 
[      3990] Drop packet: originator packet from myself (via neighbour) 
[      3990]  
[      4020] Received BATMAN packet via NB: 10.0.0.3, IF: wlan0 10.0.0.4 (from OG: 10.0.0.4, via old OG: 10.0.0.4, seqno 4, tq 22, TTL 49, V 5, IDF 1) 
[      4020] count own bcast (is_my_orig): old = 2, [      4020] new = 3 
[      4020] Drop packet: originator packet from myself (via neighbour) 
[      4020]  
[      4310] Received BATMAN packet via NB: 10.0.0.55, IF: wlan0 10.0.0.4 (from OG: 10.0.0.55, via old OG: 10.0.0.55, seqno 7, tq 255, TTL 50, V 5, IDF 0) 
[      4310] updating last_seqno: old 6, new 7 
[      4310] bidirectional: orig = 10.0.0.55       neigh = 10.0.0.55       => own_bcast =  2, real recv =  2, local tq: 255, asym_penalty:  24, total tq:  24 
[      4310] update_originator(): Searching and updating originator entry of received packet,  
[      4310] Updating existing last-hop neighbour of originator
[      4310] update_routes() 
[      4310] schedule_forward_packet():  
[      4310] forwarding: tq_orig: 24, tq_avg: 18, tq_forw: 23, ttl_orig: 49, ttl_forw: 49 
[      4310] Forward packet: rebroadcast neighbour packet with direct link flag 
[      4310]  
[      4440]  
[      4450]  
[      4450] Forwarding packet (originator 10.0.0.55, seqno 7, TQ 22, TTL 49, IDF on) on interface wlan0
[      4450] ------------------ DEBUG ------------------ 
[      4450] Forward list 
[      4450]     10.0.0.4 at 4840 
[      4450] Originator list 
[      4450]   Originator  (#/255)         Nexthop [outgoingIF]:   Potential nexthops
[      4450]        10.0.0.3 ( 12)        10.0.0.3 [     wlan0], last_valid: 3580: 
[      4450]         10.0.0.3 ( 12) 
[      4450]       10.0.0.55 ( 18)       10.0.0.55 [     wlan0], last_valid: 4310: 
[      4450]        10.0.0.55 ( 18) 
[      4450] ---------------------------------------------- END DEBUG
